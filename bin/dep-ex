#!/usr/bin/expect

log_file -noappend /tmp/deploy.log

# never time out
set timeout -1

# The script expects Password any number of times and answers with the correct password

send_user "Passphrase?\ "
expect_user -re "(.*)\n" {set PASSPHRASE $expect_out(1,string)}

send `pwd`

# This spawns the deploy
spawn /home/philip/Projects/deploy/bin/dep

expect {
  -re "Enter passphrase for key" {
    send "$PASSPHRASE\r"
    exp_continue
  }
}

# puts $expect_out(buffer)
log_file

